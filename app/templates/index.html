<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <script async defer src="https://download.agora.io/sdk/release/AgoraRTC_N-4.20.2.js"></script>
    <title>For Glory</title>
    <link rel="stylesheet" href="/static/app.css">
</head>
<body>
<div id="toast">Notifica√ß√£o</div>

<div id="modal-incoming-call" class="modal hidden">
    <div class="modal-box" style="border-color: #2ecc71;">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;" data-i18n="incoming_call">CHAMADA RECEBIDA</h2>
        <img id="incoming-call-av" src="" style="width:80px;height:80px;border-radius:50%;border:3px solid #2ecc71; margin:10px auto; display:block; object-fit:cover;">
        <h3 id="incoming-call-name" style="color:white; margin:10px 0;">...</h3>
        <p style="color:#aaa; font-size:14px; margin-bottom:20px;">est√° chamando...</p>
        <div style="display:flex; gap:10px; margin-top:8px;">
            <button onclick="acceptCall()" class="btn-main" style="background:linear-gradient(135deg,#2ecc71,#1a9e56);color:#050709;margin-top:0;border-radius:50px;display:flex;align-items:center;justify-content:center;gap:8px;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.41 2 2 0 0 1 3.6 1.21h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.81a16 16 0 0 0 6.29 6.29l.96-.96a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg> ACEITAR</button>
            <button onclick="declineCall()" class="btn-main" style="background:linear-gradient(135deg,#ff4d6d,#c0392b);color:white;margin-top:0;border-radius:50px;display:flex;align-items:center;justify-content:center;gap:8px;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg> RECUSAR</button>
        </div>
    </div>
</div>

<div class="lang-dropdown" id="lang-dropdown-global" style="display:none;">
    <div class="lang-btn" id="lang-btn-current">üåç Idioma</div>
    <div class="lang-content">
        <div class="lang-item" onclick="changeLanguage('pt')">üáßüá∑ Portugu√™s</div>
        <div class="lang-item" onclick="changeLanguage('en')">üá∫üá∏ English</div>
        <div class="lang-item" onclick="changeLanguage('es')">üá™üá∏ Espa√±ol</div>
    </div>
</div>

<div id="emoji-picker" style="position:absolute;bottom:80px;right:10px;width:90%;max-width:320px;background:rgba(20,25,35,0.95);border:1px solid var(--border);border-radius:15px;display:none;flex-direction:column;z-index:10001;box-shadow:0 0 25px rgba(0,0,0,0.8);backdrop-filter:blur(10px)">
    <div style="padding:10px 15px;display:flex;justify-content:space-between;border-bottom:1px solid #333">
        <span style="color:var(--primary);font-weight:bold;font-family:'Rajdhani'">EMOJIS</span>
        <span onclick="toggleEmoji(true)" style="color:#ff5555;cursor:pointer;font-weight:bold">‚úï</span>
    </div>
    <div id="emoji-grid" style="display:grid;grid-template-columns:repeat(7,1fr);gap:5px;padding:10px;max-height:220px;overflow-y:auto"></div>
</div>

<!-- Bot√£o flutuante da call - redesenhado -->
<div id="floating-call-btn" onclick="toggleCallPanel()" title="Abrir painel da call">
    <div class="fcb-ring"></div>
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.41 2 2 0 0 1 3.6 1.21h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.81a16 16 0 0 0 6.29 6.29l.96-.96a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
</div>

<!-- Painel da call - completamente redesenhado -->
<div id="expanded-call-panel">
    <!-- Overlay de fundo -->
    <div class="cp-backdrop"></div>

    <!-- Header: status + tempo -->
    <div class="cp-header">
        <div class="cp-status-dot" id="call-hud-status-icon">‚óè</div>
        <span class="cp-status-text" id="call-hud-status">AGUARDANDO...</span>
        <span class="cp-timer" id="call-hud-time">00:00</span>
        <button class="cp-minimize-btn" onclick="toggleCallPanel()" title="Minimizar">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="18 15 12 9 6 15"/></svg>
        </button>
    </div>

    <!-- Avatar e nome do participante ativo -->
    <div id="call-active-profile" class="cp-avatar-section">
        <div class="cp-avatar-ring">
            <img id="call-active-avatar" src="" class="cp-avatar-img" onerror="this.src='/static/default-avatar.svg'">
        </div>
        <div id="call-active-name" class="cp-active-name">Conectando...</div>
    </div>

    <!-- Lista de participantes -->
    <div id="call-users-list" class="cp-users-list"></div>

    <!-- Bot√£o de fundo -->
    <div id="call-bg-action" class="cp-bg-action" style="display:none;">
        <input type="file" id="call-bg-file" style="display:none;" accept="image/*" onchange="uploadCallBg(this)">
        <button class="cp-bg-btn" onclick="document.getElementById('call-bg-file').click()">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
            TROCAR FUNDO
        </button>
    </div>

    <!-- Controles -->
    <div class="cp-controls">
        <button id="btn-mute-call" class="cp-ctrl-btn cp-ctrl-mic" onclick="toggleMuteCall()" title="Mutar">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
        </button>
        <button class="cp-ctrl-btn cp-ctrl-end" onclick="leaveCall()" title="Encerrar">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"/><line x1="23" y1="1" x2="1" y2="23"/></svg>
        </button>
    </div>
</div>

<div id="modal-login" class="modal">
    <div class="modal-box">
        <h1 style="color:var(--primary);font-family:'Rajdhani';font-size:42px;margin:0 0 10px 0" data-i18n="login_title">FOR GLORY</h1>
        <div id="login-form">
            <input id="l-user" class="inp" placeholder="CODINOME" data-i18n="codename">
            <input id="l-pass" class="inp" type="password" placeholder="SENHA" data-i18n="password" onkeypress="if(event.key==='Enter')doLogin()">
            <button onclick="doLogin()" class="btn-main" data-i18n="login">ENTRAR</button>
            <div style="margin-top:20px;display:flex;justify-content:space-between">
                <span onclick="toggleAuth('register')" class="btn-link" style="color:white;text-decoration:none;" data-i18n="create_acc">Criar Conta</span>
                <span onclick="toggleAuth('forgot')" class="btn-link" style="color:var(--primary);text-decoration:none;" data-i18n="forgot">Esqueci Senha</span>
            </div>
            <div style="margin-top:15px;border-top:1px solid #333;padding-top:15px;">
                <div class="lang-dropdown" id="lang-dropdown-login">
                    <div class="lang-btn" id="lang-btn-login">üåç Idioma</div>
                    <div class="lang-content">
                        <div class="lang-item" onclick="changeLanguage('pt')">üáßüá∑ Portugu√™s</div>
                        <div class="lang-item" onclick="changeLanguage('en')">üá∫üá∏ English</div>
                        <div class="lang-item" onclick="changeLanguage('es')">üá™üá∏ Espa√±ol</div>
                    </div>
                </div>
            </div>
        </div>
        <div id="register-form" class="hidden">
            <input id="r-user" class="inp" placeholder="NOVO USU√ÅRIO" data-i18n="new_user">
            <input id="r-email" class="inp" placeholder="EMAIL" data-i18n="email_real">
            <input id="r-pass" class="inp" type="password" placeholder="SENHA" data-i18n="password">
            <button onclick="doRegister()" class="btn-main" data-i18n="enlist">ALISTAR-SE</button>
            <p onclick="toggleAuth('login')" class="btn-link" data-i18n="back">Voltar</p>
        </div>
        <div id="forgot-form" class="hidden">
            <h3 style="color:white" data-i18n="recover">RECUPERAR ACESSO</h3>
            <input id="f-email" class="inp" placeholder="SEU EMAIL" data-i18n="reg_email">
            <button onclick="requestReset()" class="btn-main" data-i18n="send_link">ENVIAR LINK</button>
            <p onclick="toggleAuth('login')" class="btn-link" data-i18n="back">Voltar</p>
        </div>
        <div id="reset-form" class="hidden">
            <h3 style="color:var(--primary)" data-i18n="new_pass_title">NOVA SENHA</h3>
            <input id="new-pass" class="inp" type="password" placeholder="NOVA SENHA" data-i18n="new_pass">
            <button onclick="doResetPassword()" class="btn-main" data-i18n="save_pass">SALVAR SENHA</button>
        </div>
    </div>
</div>

<div id="modal-delete" class="modal hidden">
    <div class="modal-box" style="border-color: rgba(255, 85, 85, 0.3);">
        <h2 style="color:#ff5555; font-family:'Rajdhani'; margin-top:0;" data-i18n="confirm_action">CONFIRMAR A√á√ÉO</h2>
        <p style="color:#ccc; margin: 15px 0; font-size:15px;" data-i18n="confirm_del">Tem certeza que deseja apagar isto?</p>
        <div style="display:flex; gap:10px; margin-top:20px;">
            <button id="btn-confirm-delete" class="btn-main" style="background:linear-gradient(135deg,#ff4d6d,#c0392b);color:white;margin-top:0;border-radius:50px;" data-i18n="delete">APAGAR</button>
            <button onclick="document.getElementById('modal-delete').classList.add('hidden')" class="btn-main" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:#9ca3af;margin-top:0;border-radius:50px;" data-i18n="cancel">CANCELAR</button>
        </div>
    </div>
</div>

<div id="modal-create-comm" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;" data-i18n="new_base">NOVA BASE OFICIAL</h2>
        <input type="file" id="comm-avatar-upload" class="inp" accept="image/*" title="Avatar da Base">
        <p style="color:#aaa;font-size:11px;text-align:left;margin:0 0 5px 5px;" data-i18n="base_banner_opt">Banner da Base (Opcional):</p>
        <input type="file" id="comm-banner-upload" class="inp" accept="image/*" title="Banner da Base">
        <input id="new-comm-name" class="inp" placeholder="Nome" data-i18n="base_name">
        <input id="new-comm-desc" class="inp" placeholder="Desc" data-i18n="base_desc">
        <select id="new-comm-priv" class="styled-select">
            <option value="0" data-i18n="pub_base">üåç P√∫blica</option>
            <option value="1" data-i18n="priv_base">üîí Privada</option>
        </select>
        <button onclick="submitCreateComm(event)" class="btn-main" data-i18n="establish">ESTABELECER</button>
        <button onclick="document.getElementById('modal-create-comm').classList.add('hidden')" class="btn-link" style="display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">CANCELAR</button>
    </div>
</div>

<div id="modal-edit-comm" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;" data-i18n="edit_base">EDITAR BASE</h2>
        <label style="color:#aaa;display:block;margin-top:10px;font-size:12px;" data-i18n="base_avatar">Novo Avatar</label>
        <input type="file" id="edit-comm-avatar" class="inp" accept="image/*">
        <label style="color:#aaa;display:block;margin-top:10px;font-size:12px;" data-i18n="base_banner">Novo Banner</label>
        <input type="file" id="edit-comm-banner" class="inp" accept="image/*">
        <button id="btn-save-comm" onclick="submitEditComm()" class="btn-main" data-i18n="save">SALVAR</button>
        <button onclick="document.getElementById('modal-edit-comm').classList.add('hidden')" class="btn-link" style="display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">CANCELAR</button>
    </div>
</div>

<div id="modal-create-channel" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;" data-i18n="new_channel">NOVO CANAL</h2>
        <input id="new-ch-name" class="inp" placeholder="Nome" data-i18n="channel_name">
        <p style="color:#aaa;font-size:11px;text-align:left;margin:0 0 5px 5px;" data-i18n="ch_banner_opt">Banner do Canal:</p>
        <input type="file" id="new-ch-banner" class="inp" accept="image/*" title="Banner do Canal">
        <select id="new-ch-type" class="styled-select">
            <option value="livre" data-i18n="ch_free">üí¨ Livre</option>
            <option value="text" data-i18n="ch_text">üìù S√≥ Texto</option>
            <option value="media" data-i18n="ch_media">üé¨ S√≥ M√≠dia</option>
            <option value="voice" data-i18n="voice_channel">üéôÔ∏è Canal de Voz</option>
        </select>
        <select id="new-ch-priv" class="styled-select">
            <option value="0" data-i18n="ch_pub">üåç P√∫blico</option>
            <option value="1" data-i18n="ch_priv">üîí Privado</option>
        </select>
        <button id="btn-create-ch" onclick="submitCreateChannel()" class="btn-main" data-i18n="create_channel">CRIAR CANAL</button>
        <button onclick="document.getElementById('modal-create-channel').classList.add('hidden')" class="btn-link" style="display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">CANCELAR</button>
    </div>
</div>

<div id="modal-edit-channel" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;">EDITAR CANAL</h2>
        <input id="edit-ch-name" class="inp" placeholder="Novo Nome">
        <p style="color:#aaa;font-size:11px;text-align:left;margin:0 0 5px 5px;">Novo Banner:</p>
        <input type="file" id="edit-ch-banner" class="inp" accept="image/*">
        <select id="edit-ch-type" class="styled-select">
            <option value="livre">üí¨ Livre</option><option value="text">üìù S√≥ Texto</option>
            <option value="media">üé¨ S√≥ M√≠dia</option><option value="voice">üéôÔ∏è Canal de Voz</option>
        </select>
        <select id="edit-ch-priv" class="styled-select">
            <option value="0">üåç P√∫blico</option><option value="1">üîí Privado</option>
        </select>
        <button id="btn-edit-ch" onclick="submitEditChannel()" class="btn-main" data-i18n="save">SALVAR</button>
        <button onclick="window.deleteTarget={type:'channel', id:window.currentEditChannelId}; document.getElementById('modal-delete').classList.remove('hidden');" class="btn-main" style="background:#ff5555; color:white; margin-top:10px;">DELETAR CANAL</button>
        <button onclick="document.getElementById('modal-edit-channel').classList.add('hidden')" class="btn-link" style="display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">CANCELAR</button>
    </div>
</div>

<div id="modal-create-group" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary); font-family:'Rajdhani'; margin-top:0;" data-i18n="new_squad">NOVO ESQUADR√ÉO</h2>
        <input id="new-group-name" class="inp" placeholder="Grupo" data-i18n="group_name">
        <p style="color:#888;font-size:12px;text-align:left;margin-bottom:5px;" data-i18n="select_allies">Selecione os aliados:</p>
        <div id="group-friends-list" style="max-height:150px; overflow-y:auto; text-align:left; margin-bottom:15px; background:rgba(0,0,0,0.3); padding:10px; border-radius:10px;"></div>
        <div style="display:flex; gap:10px;">
            <button onclick="submitCreateGroup()" class="btn-main" style="margin-top:0;" data-i18n="create">CRIAR</button>
            <button onclick="document.getElementById('modal-create-group').classList.add('hidden')" class="btn-main" style="background:transparent; border:1px solid #444; color:#888; margin-top:0;" data-i18n="cancel">CANCELAR</button>
        </div>
    </div>
</div>

<div id="modal-upload" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:white" data-i18n="new_post">NOVO POST</h2>
        <input type="file" id="file-upload" class="inp" accept="image/*,video/*" style="margin-bottom: 5px;">
        <span style="color:#ffaa00; font-size:11px; display:block; text-align:left; padding-left:5px; font-weight:bold;">‚ö†Ô∏è Max 100MB</span>
        <div style="display:flex;gap:5px;align-items:center;margin-bottom:10px;margin-top:10px">
            <input type="text" id="caption-upload" class="inp" placeholder="Legenda..." data-i18n="caption_placeholder" style="margin:0">
            <button type="button" class="icon-btn" onclick="openEmoji('caption-upload')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></button>
        </div>
        <div id="upload-progress" style="display:none;background:#333;height:6px;border-radius:3px;margin-top:10px;overflow:hidden">
            <div id="progress-bar" style="width:0%;height:100%;background:var(--primary);transition:width 0.2s"></div>
        </div>
        <div id="progress-text" style="color:var(--primary);font-size:12px;margin-top:5px;display:none;font-weight:bold">0%</div>
        <button id="btn-pub" onclick="submitPost()" class="btn-main" data-i18n="publish">PUBLICAR (+50 XP)</button>
        <button onclick="closeUpload()" class="btn-link" style="color:#888;display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">CANCELAR</button>
    </div>
</div>

<div id="modal-profile" class="modal hidden">
    <div class="modal-box">
        <h2 style="color:var(--primary)" data-i18n="edit_profile">EDITAR PERFIL</h2>
        <label style="color:#aaa;display:block;margin-top:10px;font-size:12px;">Avatar</label>
        <input type="file" id="avatar-upload" class="inp" accept="image/*">
        <label style="color:#aaa;display:block;margin-top:10px;font-size:12px;">Cover</label>
        <input type="file" id="cover-upload" class="inp" accept="image/*">
        <input id="bio-update" class="inp" placeholder="Bio" data-i18n="bio_placeholder">
        <button id="btn-save-profile" onclick="updateProfile()" class="btn-main" data-i18n="save">SALVAR</button>
        <button onclick="document.getElementById('modal-profile').classList.add('hidden')" class="btn-link" style="display:block;width:100%;border:1px solid #444;border-radius:10px;padding:12px;text-decoration:none" data-i18n="cancel">FECHAR</button>
    </div>
</div>

<div id="app">
    <div id="sidebar">
        <button id="nav-profile-btn" class="nav-btn" onclick="goView('profile', this)" style="position:relative;">
            <img id="nav-avatar" src="" class="my-avatar-mini" onerror="this.src='https://ui-avatars.com/api/?name=User&background=111&color=66fcf1'">
            <div id="profile-badge" class="nav-badge"></div>
        </button>
        <button class="nav-btn" onclick="goView('inbox', this)" style="position:relative;"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg><div id="inbox-badge" class="nav-badge"></div></button>
        <button class="nav-btn" onclick="goView('feed', this)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg></button>
        <button class="nav-btn" onclick="goView('mycomms', this)" style="position:relative;"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><div id="bases-badge" class="nav-badge"></div></button>
        <button class="nav-btn" onclick="goView('explore', this)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg></button>
        <button class="nav-btn" onclick="goView('history', this)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-3.5"/></svg></button>
    </div>
    
    <div id="content-area">
        <div id="view-profile" class="view">
            <div class="profile-header-container">
                <img id="p-cover" src="" class="profile-cover" onerror="this.src='https://placehold.co/600x200/0b0c10/66fcf1?text=FOR+GLORY'">
                <div class="profile-pic-lg-wrap">
                    <img id="p-avatar" src="" class="profile-pic-lg" onclick="document.getElementById('modal-profile').classList.remove('hidden')" onerror="this.src='https://ui-avatars.com/api/?name=User&background=111&color=66fcf1'">
                    <div id="my-status-dot" class="status-dot status-dot-lg online"></div>
                </div>
            </div>
            <div style="text-align:center;margin-top:10px">
                <h2 id="p-name" style="color:white;font-family:'Rajdhani';font-size:28px;margin:5px 0;">...</h2>
                <div id="p-emblems" style="margin-bottom:10px;"></div>
                <p id="p-bio" style="color:#888;margin:10px 0 20px 0;font-style:italic;">...</p>
            </div>
            <div id="p-progression-box"></div>
            <div id="p-medals-box" style="text-align:center;"></div>
            <div style="width:90%; max-width:400px; margin:0 auto; text-align:center; border-top:1px solid #333; padding-top:20px;">
                <button id="btn-stealth" onclick="toggleStealth()" class="glass-btn" style="width:100%; margin-bottom:20px;" data-i18n="stealth_on">MODO FURTIVO</button>
                <div class="search-glass">
                    <input id="search-input" placeholder="Buscar..." data-i18n="search_soldier" onkeypress="if(event.key==='Enter')searchUsers()">
                    <button type="button" onclick="searchUsers()" style="background:none;border:none;color:var(--primary);font-size:18px;cursor:pointer;">üîç</button>
                    <button type="button" onclick="clearSearch()" style="background:none;border:none;color:#ff5555;font-size:18px;cursor:pointer;padding-left:10px;">‚úï</button>
                </div>
                <div id="search-results"></div>
                <div style="display:flex; gap:10px; margin-top:10px">
                    <button onclick="toggleRequests('requests')" class="glass-btn" data-i18n="requests">üì© Solicita√ß√µes</button>
                    <button onclick="toggleRequests('friends')" class="glass-btn" data-i18n="friends">üë• Amigos</button>
                </div>
                <div id="requests-list" style="margin-top:15px; background:rgba(0,0,0,0.3); border-radius:10px;"></div>
                <div style="margin-top:30px;border-top:1px solid #333;padding-top:20px;text-align:center;">
                    <p style="color:#888;font-size:12px;margin-bottom:10px;">üåç Idioma / Language</p>
                    <div style="display:flex;justify-content:center;gap:10px;">
                        <button onclick="changeLanguage('pt')" class="glass-btn" style="padding:6px 12px;margin:0;font-size:13px;">üáßüá∑ PT</button>
                        <button onclick="changeLanguage('en')" class="glass-btn" style="padding:6px 12px;margin:0;font-size:13px;">üá∫üá∏ EN</button>
                        <button onclick="changeLanguage('es')" class="glass-btn" style="padding:6px 12px;margin:0;font-size:13px;">üá™üá∏ ES</button>
                    </div>
                </div>
                <button onclick="logout()" class="glass-btn danger-btn" style="margin-top:20px;" data-i18n="disconnect">DESCONECTAR</button>
            </div>
        </div>
        
        <div id="view-inbox" class="view">
            <div style="padding:15px;display:flex;align-items:center;justify-content:space-between;background:rgba(0,0,0,0.2);border-bottom:1px solid rgba(255,255,255,0.05);">
                <div style="color:var(--primary);font-family:'Rajdhani';font-weight:bold;letter-spacing:2px;font-size:20px;" data-i18n="private_msgs">MENSAGENS PRIVADAS</div>
                <button onclick="openCreateGroupModal()" class="glass-btn" style="padding:8px 12px; margin:0; flex:none;" data-i18n="group_x1">+ GRUPO X1</button>
            </div>
            <div id="inbox-list" style="padding:15px; display:flex; flex-direction:column; gap:10px; overflow-y:auto; flex:1;"></div>
        </div>
        
        <div id="view-feed" class="view active">
            <div id="feed-container"></div>
            <button class="btn-float" onclick="document.getElementById('modal-upload').classList.remove('hidden')"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg></button>
        </div>
        
        <div id="view-mycomms" class="view">
            <div style="padding:20px; background:rgba(0,0,0,0.3); border-bottom:1px solid #333; display:flex; justify-content:space-between; align-items:center;">
                <span style="color:white; font-family:'Rajdhani'; font-weight:bold; font-size:24px; letter-spacing:1px;" data-i18n="my_bases">üõ°Ô∏è MINHAS BASES</span>
                <button class="glass-btn" style="margin:0; flex:none; padding:8px 15px;" onclick="document.getElementById('modal-create-comm').classList.remove('hidden')" data-i18n="create_base">+ CRIAR BASE</button>
            </div>
            <div style="padding:20px; flex:1; overflow-y:auto; text-align:center;">
                <div id="my-comms-grid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:15px; margin-bottom:40px;"></div>
            </div>
        </div>
        
        <div id="view-explore" class="view">
            <div style="padding:20px; background:rgba(0,0,0,0.3); border-bottom:1px solid #333; text-align:center;">
                <span style="color:var(--primary); font-family:'Rajdhani'; font-weight:bold; font-size:24px; letter-spacing:1px;" data-i18n="explore_bases">üåê EXPLORAR BASES</span>
            </div>
            <div style="padding:20px; flex:1; overflow-y:auto; text-align:center;">
                <div class="search-glass" style="max-width:400px; margin:0 auto 20px auto;">
                    <input id="search-comm-input" placeholder="Buscar..." data-i18n="search_base" onkeypress="if(event.key==='Enter')searchComms()">
                    <button type="button" onclick="searchComms()" style="background:none;border:none;color:var(--primary);font-size:18px;cursor:pointer;">üîç</button>
                    <button type="button" onclick="clearCommSearch()" style="background:none;border:none;color:#ff5555;font-size:18px;cursor:pointer;padding-left:10px;">‚úï</button>
                </div>
                <div id="public-comms-grid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(140px, 1fr)); gap:15px; margin-bottom:40px;"></div>
            </div>
        </div>
        
        <div id="view-history" class="view">
            <div style="padding:20px; background:rgba(0,0,0,0.3); border-bottom:1px solid #333; text-align:center;">
                <span style="color:white; font-family:'Rajdhani'; font-weight:bold; font-size:24px; letter-spacing:1px;" data-i18n="my_history">üïí MEU HIST√ìRICO</span>
            </div>
            <div style="padding:20px; flex:1; overflow-y:auto; text-align:center;">
                <div id="my-posts-grid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(150px, 1fr)); gap:10px; margin:0 auto; max-width:800px;"></div>
            </div>
        </div>
        
        <div id="view-dm" class="view" style="justify-content:center; padding:15px; background:rgba(0,0,0,0.5);">
            <div class="chat-box-centered">
                <div style="padding:15px;display:flex;align-items:center;background:rgba(0,0,0,0.4);border-bottom:1px solid rgba(255,255,255,0.05); gap:10px;">
                    <button onclick="goView('inbox', document.querySelectorAll('.nav-btn')[1])" style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.08);color:#9ca3af;font-size:18px;cursor:pointer;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>
                    <div id="dm-header-name" style="color:white;font-family:'Rajdhani';font-weight:bold;letter-spacing:1px;font-size:18px;flex:1;">Chat</div>
                    <button onclick="initCall(currentChatType, currentChatId)" class="glass-btn btn-call-header" style="flex:none; padding:8px 15px; border-color:#2ecc71; color:#2ecc71;">üìû CALL</button>
                </div>
                <div id="dm-list"></div>
                <form id="dm-input-area" class="chat-input-area" onsubmit="sendDM(); return false;">
                    <input type="file" id="dm-file" class="hidden" onchange="uploadDMImage()" accept="image/*,video/*,audio/*">
                    <button type="button" class="icon-btn" onclick="document.getElementById('dm-file').click()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg></button>
                    <button type="button" class="icon-btn" id="btn-mic-dm" onclick="toggleRecord('dm')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg></button>
                    <input id="dm-msg" class="chat-msg" placeholder="Mensagem" data-i18n="msg_placeholder" autocomplete="off">
                    <button type="button" class="icon-btn" onclick="openEmoji('dm-msg')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></button>
                    <button type="submit" class="btn-send-msg"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button>
                </form>
            </div>
        </div>
        
        <div id="view-comm-dashboard" class="view comm-layout">
            <div class="comm-topbar" id="comm-header">
                <button onclick="closeComm()" style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:50%;width:36px;height:36px;color:white;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg></button>
                <div id="active-comm-name">NOME DA BASE</div>
                <button onclick="showCommInfo()" class="glass-btn" style="padding:6px 12px; margin:0; flex:none; background:rgba(255,255,255,0.1); color:white; border-color:#555;">‚ÑπÔ∏è INFO</button>
            </div>
            <div class="comm-channels-bar" id="comm-channels-bar"></div>
            
            <div id="comm-chat-area" style="display:flex; flex-direction:column; flex:1; overflow:hidden;">
                <div id="comm-chat-list" style="flex:1; overflow-y:auto; padding:15px; display:flex; flex-direction:column; gap:12px;"></div>
                <form id="comm-input-form" class="chat-input-area" onsubmit="sendCommMsg(); return false;">
                    <input type="file" id="comm-file" class="hidden" onchange="uploadCommImage()" accept="image/*,video/*,audio/*">
                    <button type="button" id="btn-comm-clip" class="icon-btn" onclick="document.getElementById('comm-file').click()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg></button>
                    <button type="button" id="btn-comm-mic" class="icon-btn" onclick="toggleRecord('comm')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg></button>
                    <input id="comm-msg" class="chat-msg" placeholder="Mensagem" data-i18n="base_msg_placeholder" autocomplete="off">
                    <button type="button" id="btn-comm-emoji" class="icon-btn" onclick="openEmoji('comm-msg')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></button>
                    <button type="submit" id="btn-comm-send" class="btn-send-msg"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button>
                </form>
            </div>
            
            <div id="comm-info-area" style="display:none; flex:1; overflow-y:auto; padding-bottom:30px; align-items:flex-start; justify-content:center; flex-direction:row; background: var(--dark-bg);">
                <div style="background:var(--card-bg); border:1px solid var(--border); border-radius:16px; width:100%; max-width:600px; margin-top:20px; overflow:hidden; box-shadow:0 15px 35px rgba(0,0,0,0.5);">
                    <div id="c-info-banner" style="width:100%; height:160px; background-size:cover; background-position:center; position:relative; background-color:#111; border-bottom:1px solid #333;">
                        <div style="position:absolute; bottom:-40px; left:25px;">
                            <img id="c-info-av" src="" style="width:100px; height:100px; border-radius:24px; object-fit:cover; border:4px solid var(--card-bg); background:#0b0c10; box-shadow: 0 4px 15px rgba(0,0,0,0.5);">
                        </div>
                    </div>
                    <div style="padding: 50px 25px 25px 25px;">
                        <h2 id="c-info-name" style="color:white; margin:0; font-family:'Rajdhani'; font-size:32px; letter-spacing:1px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">...</h2>
                        <p id="c-info-desc" style="color:#aaa; font-size:14px; margin:10px 0 25px 0; line-height:1.5;">...</p>
                        
                        <div id="c-info-admin-btn" style="margin-bottom:20px; display:flex; flex-direction:column; gap:10px;"></div>
                        
                        <div style="background:rgba(0,0,0,0.3); border-radius:12px; padding:20px; text-align:left; border:1px solid rgba(255,255,255,0.05);">
                            <h3 style="color:var(--primary); margin:0 0 15px 0; border-bottom:1px solid rgba(102,252,241,0.2); padding-bottom:8px; font-size:16px; font-family:'Rajdhani'; letter-spacing:1px; text-transform:uppercase;" data-i18n="base_members">Membros da Base</h3>
                            <div id="c-info-members" style="display:flex; flex-direction:column; gap:8px; max-height:300px; overflow-y:auto; padding-right:5px;"></div>
                        </div>
                        
                        <div id="c-info-requests-container" style="display:none; width:100%; margin-top:20px; background:rgba(0,0,0,0.3); border-radius:12px; padding:20px; text-align:left; border:1px solid rgba(255,165,0,0.2);">
                            <h3 style="color:orange; margin:0 0 15px 0; border-bottom:1px solid rgba(255,165,0,0.2); padding-bottom:8px; font-size:16px; font-family:'Rajdhani'; letter-spacing:1px; text-transform:uppercase;" data-i18n="entry_requests">Solicita√ß√µes de Entrada</h3>
                            <div id="c-info-requests" style="display:flex; flex-direction:column; gap:8px;"></div>
                        </div>
                        
                        <div id="c-info-destroy-btn" style="margin-top:25px; display:flex; flex-direction:column; gap:10px;"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="view-public-profile" class="view">
            <button onclick="goView('feed', document.querySelectorAll('.nav-btn')[2])" style="position:absolute;top:20px;left:20px;z-index:10;background:rgba(0,0,0,0.6);color:white;border:1px solid rgba(255,255,255,0.12);padding:9px 16px;border-radius:50px;backdrop-filter:blur(12px);cursor:pointer;display:flex;align-items:center;gap:8px;font-size:14px;font-weight:600;" data-i18n="back"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg> Voltar</button>
            <div class="profile-header-container">
                <img id="pub-cover" src="" class="profile-cover" onerror="this.src='https://placehold.co/600x200/0b0c10/66fcf1?text=FOR+GLORY'">
                <div class="profile-pic-lg-wrap">
                    <img id="pub-avatar" src="" class="profile-pic-lg" onerror="this.src='https://ui-avatars.com/api/?name=User&background=111&color=66fcf1'">
                    <div id="pub-status-dot" class="status-dot status-dot-lg"></div>
                </div>
            </div>
            <div style="text-align:center;margin-top:20px">
                <h2 id="pub-name" style="color:white;font-family:'Rajdhani';margin:5px 0;">...</h2>
                <div id="pub-emblems" style="margin-bottom:10px;"></div>
                <p id="pub-bio" style="color:#888;margin:10px 0 20px 0;">...</p>
                <div id="pub-medals-box" style="text-align:center;"></div>
                <div id="pub-actions" style="margin-bottom:20px; display:flex; justify-content:center; flex-wrap:wrap; align-items:center; gap:10px;"></div>
                <div id="pub-grid" style="display:grid;grid-template-columns:repeat(3,1fr);gap:2px;max-width:500px;margin:0 auto;"></div>
            </div>
        </div>
    </div>
</div>

<script src="/static/app.js" defer></script>
</body>
</html>
